import json
from dateutil.parser import parse

def gimmeSupermaster(jsonArg):
    jsonList = json.loads(jsonArg)
    jsonList.sort(key=lambda k: parse(k['startTime']))
    return jsonList[0]["uuid"]

if __name__ == '__main__':
#    sm = gimmeSupermaster('[{"linkDownload":"https://scihub.esa.int/dhus/odata/v1/Products(\'4461460c-803a-4bda-9ffe-7582c85b7977\')/$value","uuid":"5561460c-803a-4bda-9ffe-7582c85b7999"},{"linkDownload":"https://scihub.esa.int/dhus/odata/v1/Products(\'3361460c-803a-4bda-9ffe-7582c85b7977\')/$value","uuid":"3361460c-803a-4bda-9ffe-7582c85b7977"},{"linkDownload":"https://scihub.esa.int/dhus/odata/v1/Products(\'3cc6951a-359b-4ed3-8ca6-f1d3f0841d89\')/$value","uuid":"3cc6951a-359b-4ed3-8ca6-f1d3f0841d89"}]')
    sm = gimmeSupermaster('[{"totalSlices":"6","missionDataTakeID":"46780","instrumentConfigurationID":"5","location":{"type":"Polygon","coordinates":[[[39.701187,9.377091],[40.094845,12.295123],[38.303329,12.665706],[37.908436,9.82335],[39.701187,9.377091]]]},"superMaster":false,"orbitNumberStop":"8137","linkDownload":"https://scihub.esa.int/dhus/odata/v1/Products(\'032e216f-195e-49a7-9983-fdcb008e77a0\')/$value","familyName":"SENTINEL-1","productClass":"S","sliceNumber":"1","number":"A","relativeOrbitNumberStop":"15","relativeOrbitNumberStart":"15","pass":"ASCENDING","stopTime":"2015-10-13T17:13:16.301929","productType":"SLC","mode":"IW","startTime":"2015-10-13T17:12:46.473752","transmitterReceiverPolarisation2":"VH","transmitterReceiverPolarisation1":"VV","ingestion":"2015-10-13T17:13:16.301Z","datasetId":"d34d9a33455834004af81d23ee96ea8c","swath":"IW1","orbitNumberStart":"8137","filename":"S1A_IW_SLC__1SDV_20151013T171246_20151013T171316_008137_00B6BC_5FB7","uuid":"032e216f-195e-49a7-9983-fdcb008e77a0"},{"totalSlices":"10","missionDataTakeID":"45586","instrumentConfigurationID":"5","location":{"type":"Polygon","coordinates":[[[39.747929,9.348081],[40.144062,12.284989],[38.524834,12.620336],[38.127621,9.752673],[39.747929,9.348081]]]},"superMaster":false,"orbitNumberStop":"7962","linkDownload":"https://scihub.esa.int/dhus/odata/v1/Products(\'deba1d34-f39c-4ac8-9a3c-d3c94f8907d2\')/$value","familyName":"SENTINEL-1","productClass":"S","sliceNumber":"5","number":"A","relativeOrbitNumberStop":"15","relativeOrbitNumberStart":"15","pass":"ASCENDING","stopTime":"2015-10-01T17:13:16.883303","productType":"SLC","mode":"IW","startTime":"2015-10-01T17:12:49.922627","transmitterReceiverPolarisation2":"VH","transmitterReceiverPolarisation1":"VV","ingestion":"2015-10-01T21:30:26.871Z","datasetId":"d34d9a33455834004af81d23ee96ea8c","swath":"IW1","orbitNumberStart":"7962","filename":"S1A_IW_SLC__1SDV_20151001T171249_20151001T171316_007962_00B212_E93A","uuid":"deba1d34-f39c-4ac8-9a3c-d3c94f8907d2"}]')
    print("SuperMaster: "+sm)